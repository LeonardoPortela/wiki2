/*! Wiki.js - wiki.js.org - Licensed under AGPL */
(this.webpackJsonp=this.webpackJsonp||[]).push([["login"],{"./client/components/login.vue":function(e,i,t){"use strict";t.r(i);var n=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("v-app",[t("div",{staticClass:"login"},[t("v-container",{attrs:{"grid-list-lg":""}},[t("v-layout",{attrs:{row:"",wrap:""}},[t("v-flex",{attrs:{xs12:"","offset-sm1":"",sm10:"","offset-md2":"",md8:"","offset-lg3":"",lg6:"","offset-xl4":"",xl4:""}},[t("transition",{attrs:{name:"fadeUp"}},[t("v-card",{directives:[{name:"show",rawName:"v-show",value:e.isShown,expression:"isShown"}],staticClass:"elevation-5 md2"},[t("v-toolbar",{attrs:{color:"primary",flat:"",dense:"",dark:""}},[t("v-spacer"),"tfa"===e.screen?t("div",{staticClass:"subheading"},[e._v(e._s(e.$t("auth:tfa.subtitle")))]):"local"!==e.selectedStrategy.key?t("div",{staticClass:"subheading"},[e._v(e._s(e.$t("auth:loginUsingStrategy",{strategy:e.selectedStrategy.title,interpolation:{escapeValue:!1}})))]):t("div",{staticClass:"subheading"},[e._v(e._s(e.$t("auth:loginRequired")))]),t("v-spacer")],1),t("v-card-text",{staticClass:"text-xs-center"},[t("h1",{staticClass:"display-1 primary--text py-2"},[e._v(e._s(e.siteTitle))]),"login"===e.screen?[t("v-text-field",{ref:"iptEmail",staticClass:"md2 mt-3",attrs:{solo:"",flat:"","prepend-icon":"email","background-color":"grey lighten-4","hide-details":"",placeholder:e.$t("auth:fields.emailUser")},model:{value:e.username,callback:function(i){e.username=i},expression:"username"}}),t("v-text-field",{ref:"iptPassword",staticClass:"md2 mt-2",attrs:{solo:"",flat:"","prepend-icon":"vpn_key","background-color":"grey lighten-4","hide-details":"","append-icon":e.hidePassword?"visibility":"visibility_off",type:e.hidePassword?"password":"text",placeholder:e.$t("auth:fields.password")},on:{"click:append":function(){return e.hidePassword=!e.hidePassword},keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.login(i)}},model:{value:e.password,callback:function(i){e.password=i},expression:"password"}})]:"tfa"===e.screen?[t("div",{staticClass:"body-2"},[e._v("Enter the security code generated from your trusted device:")]),t("v-text-field",{ref:"iptTFA",staticClass:"md2 centered mt-2",attrs:{solo:"",flat:"","background-color":"grey lighten-4","hide-details":"",placeholder:e.$t("auth:tfa.placeholder")},on:{keyup:function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:e.verifySecurityCode(i)}},model:{value:e.securityCode,callback:function(i){e.securityCode=i},expression:"securityCode"}})]:"forgot"===e.screen?[t("div",{staticClass:"body-2"},[e._v(e._s(e.$t("auth:forgotPasswordSubtitle")))]),t("v-text-field",{ref:"iptEmailForgot",staticClass:"md2 mt-3",attrs:{solo:"",flat:"","prepend-icon":"email","background-color":"grey lighten-4","hide-details":"",placeholder:e.$t("auth:fields.email")},model:{value:e.username,callback:function(i){e.username=i},expression:"username"}})]:e._e()],2),t("v-card-actions",{staticClass:"pb-4"},[t("v-spacer"),"login"===e.screen?t("v-btn",{staticClass:"md2",attrs:{block:"",large:"",color:"primary",round:"",loading:e.isLoading},on:{click:e.login}},[e._v(e._s(e.$t("auth:actions.login")))]):"tfa"===e.screen?t("v-btn",{staticClass:"md2",attrs:{block:"",large:"",color:"primary",round:"",loading:e.isLoading},on:{click:e.verifySecurityCode}},[e._v(e._s(e.$t("auth:tfa.verifyToken")))]):"forgot"===e.screen?t("v-btn",{staticClass:"md2",attrs:{block:"",large:"",color:"primary",round:"",loading:e.isLoading},on:{click:e.forgotPasswordSubmit}},[e._v(e._s(e.$t("auth:sendResetPassword")))]):e._e(),t("v-spacer")],1),"login"===e.screen&&"local"===e.selectedStrategy.key?t("v-card-actions",{staticClass:"pb-3"},[t("v-spacer"),t("a",{staticClass:"caption",attrs:{href:"#forgot"},on:{click:function(i){return i.stopPropagation(),i.preventDefault(),e.forgotPassword(i)}}},[e._v(e._s(e.$t("auth:forgotPasswordLink")))]),t("v-spacer")],1):"forgot"===e.screen?t("v-card-actions",{staticClass:"pb-3"},[t("v-spacer"),t("a",{staticClass:"caption",attrs:{href:"#cancelforgot"},on:{click:function(i){i.stopPropagation(),i.preventDefault(),e.screen="login"}}},[e._v(e._s(e.$t("auth:forgotPasswordCancel")))]),t("v-spacer")],1):e._e(),"login"===e.screen&&e.isSocialShown?[t("v-divider"),t("v-card-text",{staticClass:"grey lighten-4 text-xs-center"},[t("div",{staticClass:"pb-2 body-2 text-xs-center grey--text text--darken-2"},[e._v(e._s(e.$t("auth:orLoginUsingStrategy")))]),e._l(e.strategies,function(i){return t("v-tooltip",{key:i.key,attrs:{top:""}},[t("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"social-login-btn mr-2",class:i.color+" elevation-"+(i.key===e.selectedStrategy.key?"0":"4"),attrs:{slot:"activator"},domProps:{innerHTML:e._s(i.icon)},on:{click:function(t){return e.selectStrategy(i)}},slot:"activator"}),t("span",[e._v(e._s(i.title))])])})],2)]:e._e(),"login"===e.screen&&e.selectedStrategy.selfRegistration?[t("v-divider"),t("v-card-actions",{staticClass:"py-3",class:e.isSocialShown?"":"grey lighten-4"},[t("v-spacer"),t("i18next",{staticClass:"caption",attrs:{path:"auth:switchToRegister.text",tag:"div"}},[t("a",{staticClass:"caption",attrs:{href:"/register",place:"link"}},[e._v(e._s(e.$t("auth:switchToRegister.link")))])]),t("v-spacer")],1)]:e._e()],2)],1)],1)],1)],1)],1),t("loader",{attrs:{color:e.loaderColor,title:e.loaderTitle,subtitle:e.$t("auth:pleaseWait")},model:{value:e.isLoading,callback:function(i){e.isLoading=i},expression:"isLoading"}}),t("nav-footer",{attrs:{color:"grey darken-4"}}),t("notify")],1)};n._withStripped=!0;var s=t("./node_modules/lodash/delay.js"),a=t.n(s),o=t("./node_modules/lodash/get.js"),l=t.n(o),r=t("./node_modules/lodash/has.js"),d=t.n(r),c=t("./node_modules/lodash/find.js"),u=t.n(c),m=t("./node_modules/js-cookie/src/js.cookie.js"),g=t.n(m),v=t("./client/graph/login/login-query-strategies.gql"),f=t.n(v),k=t("./client/graph/login/login-mutation-login.gql"),p=t.n(k),h=t("./client/graph/login/login-mutation-tfa.gql"),y=t.n(h),b={i18nOptions:{namespaces:"auth"},data:()=>({error:!1,strategies:[],selectedStrategy:{key:"local"},screen:"login",username:"",password:"",hidePassword:!0,securityCode:"",loginToken:"",isLoading:!1,loaderColor:"grey darken-4",loaderTitle:"Working...",isShown:!1}),computed:{siteTitle:()=>siteConfig.title,isSocialShown(){return this.strategies.length>1}},watch:{strategies(e,i){this.selectedStrategy=u()(e,["key","local"])}},mounted(){this.isShown=!0,this.$nextTick(()=>{this.$refs.iptEmail.focus()})},methods:{selectStrategy(e){this.selectedStrategy=e,this.screen="login",e.useForm?this.$nextTick(()=>{this.$refs.iptEmail.focus()}):(this.isLoading=!0,window.location.assign("/login/"+e.key))},async login(){if(this.username.length<2)this.$store.commit("showNotification",{style:"red",message:this.$t("auth:invalidEmailUsername"),icon:"warning"}),this.$refs.iptEmail.focus();else if(this.password.length<2)this.$store.commit("showNotification",{style:"red",message:this.$t("auth:invalidPassword"),icon:"warning"}),this.$refs.iptPassword.focus();else{this.loaderColor="grey darken-4",this.loaderTitle=this.$t("auth:signingIn"),this.isLoading=!0;try{let e=await this.$apollo.mutate({mutation:p.a,variables:{username:this.username,password:this.password,strategy:this.selectedStrategy.key}});if(!d()(e,"data.authentication.login"))throw new Error(this.$t("auth:genericError"));{let i=l()(e,"data.authentication.login",{});if(!0!==i.responseResult.succeeded)throw new Error(i.responseResult.message);!0===i.tfaRequired?(this.screen="tfa",this.securityCode="",this.loginToken=i.tfaLoginToken,this.$nextTick(()=>{this.$refs.iptTFA.focus()}),this.isLoading=!1):(this.loaderColor="green darken-1",this.loaderTitle=this.$t("auth:loginSuccess"),g.a.set("jwt",i.jwt,{expires:365}),a()(()=>{window.location.replace("/")},1e3))}}catch(e){console.error(e),this.$store.commit("showNotification",{style:"red",message:e.message,icon:"warning"}),this.isLoading=!1}}},verifySecurityCode(){6!==this.securityCode.length?(this.$store.commit("showNotification",{style:"red",message:"Enter a valid security code.",icon:"warning"}),this.$refs.iptTFA.focus()):(this.isLoading=!0,this.$apollo.mutate({mutation:y.a,variables:{loginToken:this.loginToken,securityCode:this.securityCode}}).then(e=>{if(!d()(e,"data.authentication.loginTFA"))throw new Error(this.$t("auth:genericError"));{let i=l()(e,"data.authentication.loginTFA",{});if(!0!==i.responseResult.succeeded)throw new Error(i.responseResult.message);this.$store.commit("showNotification",{message:"Login successful!",style:"success",icon:"check"}),a()(()=>{window.location.replace("/")},1e3),this.isLoading=!1}}).catch(e=>{console.error(e),this.$store.commit("showNotification",{style:"red",message:e.message,icon:"warning"}),this.isLoading=!1}))},forgotPassword(){this.screen="forgot",this.$nextTick(()=>{this.$refs.iptEmailForgot.focus()})},async forgotPasswordSubmit(){this.$store.commit("showNotification",{style:"pink",message:"Coming soon!",icon:"free_breakfast"})}},apollo:{strategies:{query:f.a,update:e=>e.authentication.strategies,watchLoading(e){this.$store.commit("loading".concat(e?"Start":"Stop"),"login-strategies-refresh")}}}},S=(t("./client/components/login.vue?vue&type=style&index=0&lang=scss&"),t("./node_modules/vue-loader/lib/runtime/componentNormalizer.js")),w=Object(S.a)(b,n,[],!1,null,null,null);w.options.__file="client/components/login.vue";i.default=w.exports},"./client/components/login.vue?vue&type=style&index=0&lang=scss&":function(e,i,t){"use strict";var n=t("./node_modules/cache-loader/dist/cjs.js?!./node_modules/style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/lib/loader.js?!./node_modules/sass-resources-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!./client/components/login.vue?vue&type=style&index=0&lang=scss&");t.n(n).a},"./client/graph/login/login-mutation-login.gql":function(e,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"username"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"password"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"strategy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authentication"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"login"},arguments:[{kind:"Argument",name:{kind:"Name",value:"username"},value:{kind:"Variable",name:{kind:"Name",value:"username"}}},{kind:"Argument",name:{kind:"Name",value:"password"},value:{kind:"Variable",name:{kind:"Name",value:"password"}}},{kind:"Argument",name:{kind:"Name",value:"strategy"},value:{kind:"Variable",name:{kind:"Name",value:"strategy"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"responseResult"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"succeeded"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"errorCode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"jwt"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tfaRequired"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"tfaLoginToken"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:321}};t.loc.source={body:"mutation($username: String!, $password: String!, $strategy: String!) {\n  authentication {\n    login(username: $username, password: $password, strategy: $strategy) {\n      responseResult {\n        succeeded\n        errorCode\n        slug\n        message\n      }\n      jwt\n      tfaRequired\n      tfaLoginToken\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};t.definitions.forEach(function(e){if(e.name){var i=new Set;!function e(i,t){if("FragmentSpread"===i.kind)t.add(i.name.value);else if("VariableDefinition"===i.kind){var n=i.type;"NamedType"===n.kind&&t.add(n.name.value)}i.selectionSet&&i.selectionSet.selections.forEach(function(i){e(i,t)}),i.variableDefinitions&&i.variableDefinitions.forEach(function(i){e(i,t)}),i.definitions&&i.definitions.forEach(function(i){e(i,t)})}(e,i),n[e.name.value]=i}}),e.exports=t,t.documentId="4dac45769797282d399540d5fa6355c1c430b53437cf38b3bbc5e57b3ebd58d0"},"./client/graph/login/login-mutation-tfa.gql":function(e,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loginToken"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"securityCode"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authentication"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"loginTFA"},arguments:[{kind:"Argument",name:{kind:"Name",value:"loginToken"},value:{kind:"Variable",name:{kind:"Name",value:"loginToken"}}},{kind:"Argument",name:{kind:"Name",value:"securityCode"},value:{kind:"Variable",name:{kind:"Name",value:"securityCode"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"responseResult"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"succeeded"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"errorCode"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"slug"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"message"},arguments:[],directives:[]}]}}]}}]}}]}}],loc:{start:0,end:253}};t.loc.source={body:"mutation($loginToken: String!, $securityCode: String!) {\n  authentication {\n    loginTFA(loginToken: $loginToken, securityCode: $securityCode) {\n      responseResult {\n        succeeded\n        errorCode\n        slug\n        message\n      }\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};t.definitions.forEach(function(e){if(e.name){var i=new Set;!function e(i,t){if("FragmentSpread"===i.kind)t.add(i.name.value);else if("VariableDefinition"===i.kind){var n=i.type;"NamedType"===n.kind&&t.add(n.name.value)}i.selectionSet&&i.selectionSet.selections.forEach(function(i){e(i,t)}),i.variableDefinitions&&i.variableDefinitions.forEach(function(i){e(i,t)}),i.definitions&&i.definitions.forEach(function(i){e(i,t)})}(e,i),n[e.name.value]=i}}),e.exports=t,t.documentId="1ec25ddd589bc2291b10785dfa562cf106a36e1bdbfd83b2c88d4f61ff4a541b"},"./client/graph/login/login-query-strategies.gql":function(e,i){var t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authentication"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"strategies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isEnabled"},value:{kind:"BooleanValue",value:!0}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"useForm"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"icon"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"color"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"selfRegistration"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:167}};t.loc.source={body:"query {\n  authentication {\n    strategies(\n      isEnabled: true\n    ) {\n      key\n      title\n      useForm\n      icon\n      color\n      selfRegistration\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};t.definitions.forEach(function(e){if(e.name){var i=new Set;!function e(i,t){if("FragmentSpread"===i.kind)t.add(i.name.value);else if("VariableDefinition"===i.kind){var n=i.type;"NamedType"===n.kind&&t.add(n.name.value)}i.selectionSet&&i.selectionSet.selections.forEach(function(i){e(i,t)}),i.variableDefinitions&&i.variableDefinitions.forEach(function(i){e(i,t)}),i.definitions&&i.definitions.forEach(function(i){e(i,t)})}(e,i),n[e.name.value]=i}}),e.exports=t,t.documentId="cd0932bd3da66e665c50136de4aa5ba67d3bb48e3d7541b05f7a22437cb7ff2d"},"./node_modules/cache-loader/dist/cjs.js?!./node_modules/style-loader/index.js!./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/lib/loader.js?!./node_modules/sass-resources-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!./client/components/login.vue?vue&type=style&index=0&lang=scss&":function(e,i,t){var n=t("./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/lib/loader.js?!./node_modules/sass-resources-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!./client/components/login.vue?vue&type=style&index=0&lang=scss&");"string"==typeof n&&(n=[[e.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};t("./node_modules/style-loader/lib/addStyles.js")(n,s);n.locals&&(e.exports=n.locals)},"./node_modules/mini-css-extract-plugin/dist/loader.js!./node_modules/css-loader/dist/cjs.js!./node_modules/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/postcss-loader/src/index.js!./node_modules/sass-loader/lib/loader.js?!./node_modules/sass-resources-loader/lib/loader.js?!./node_modules/vue-loader/lib/index.js?!./client/components/login.vue?vue&type=style&index=0&lang=scss&":function(e,i,t){}}]);